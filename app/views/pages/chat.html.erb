<style>
    .card {
    background: #222;
    border: 1px solid #dd2476;
    color: rgba(250, 250, 250, 0.8);
    margin-bottom: 2rem;
    }
    .card:hover{
        background-color:#363636;
    }
</style>

<% def time_sence(date) %>
    <% seconds = (Time.now-date).to_i %>
    <% if seconds/60 <= 1 %>
        <% return seconds.to_i.to_s + "s" %>
    <% elsif seconds/(60*60) <= 1 %>
        <% return (seconds/60.to_i).to_s + 'm' %>
    <% elsif seconds/(60*60*24) <= 1 %>
        <% return (seconds/(60*60).to_i).to_s + 'h' %>
    <% elsif seconds/(60*60*24*7) <= 1 %>
        <% return (seconds/(60*60*24).to_i).to_s + "w" %>
        
    <%end%>
<%end%>

    <h1>chat</h1>
    
        <% if @match_unmessaged != []%>
        <h4>matches</h4>
            <% @match_unmessaged.each do |match| %>
            <div class="container mx-auto mt-4">
                <div class="row">
                    <div class="col-md-4">
                        <div class="card" style="width: 5rem;">
                            <%= link_to image_tag("iStock-476085198.jpg", size: "75x100") , messages_path(:message => {:match_id => match.id}), :class => "card-img-top stretched-link" %>
                            <div class="card-body">
                                <h5 class="card-title"><%= User.find(match.user_id).name.split(' ')[0] %></h5>
                            </div>
                        </div>
                    </div>
                    <!--
                    <% if match.user_id == current_user.id %>
                        <%= link_to image_tag("iStock-476085198.jpg", size: "50x70", style: "border-radius: 40px") , messages_path(:message => {:match_id => match.id}),:style => "border-radius:50%;", :class => "btn btn-primary" %>
                    <%else%>
                        <%= link_to User.find(match.user_id).name.split(' ')[0] , messages_path(:message => {:match_id => match.id}),:style => "border-radius:50%;",  :class => "btn btn-primary"  %>
                    <%end%>
                    -->
                </div>
            </div>
            <%end%>
        <%end%>
    <div class="container">
        <% if @match_messaged != []%>
        <h4> Active Chats</h4>
        <div class="mx-auto mt-4 d-flex justify-content-center">
            <% @match_messaged.each do |match| %>
                <% last_message = Message.where(:match_id => match.id).last %>
                <div class="row">
                    <div class="card" style="width: 20rem;">
                        <div class="card-body">
                            <% if match.user_id == current_user.id %>
                                <h5 class="card-title"><%= User.find(match.user2).name.split(' ')[0]  %></h5>
                                <h6 class="card-subtitle mb-2 text-muted"><%= time_sence(last_message.created_at) %></h6>
                                <p class="card-text"><%= last_message.body[0,15] %></p>          
                                <%= link_to ""  , messages_path(:message => {:match_id => match.id}), :class => "stretched-link" %>
                            <%else%>
                                <h5 class="card-title"><%= User.find(match.user_id).name.split(' ')[0]  %></h5>
                                <h6 class="card-subtitle mb-2 text-muted"><%= time_sence(last_message.created_at) %></h6>
                                <p class="card-text"><%= last_message.body[0,15] %></p>          
                                <%= link_to ""  , messages_path(:message => {:match_id => match.id}), :class => "stretched-link" %>
                            <%end%>
                        </div>
                    </div>
                </div>
            <% end %>
        </div>
        <%end%>
    </div>
    


<!--
<div class="container mx-auto mt-4">
  <div class="row">
    <div class="col-md-4">
      <div class="card" style="width: 18rem;">
  <img src="https://i.imgur.com/ZTkt4I5.jpg" class="card-img-top" alt="...">
  <div class="card-body">
    <h5 class="card-title">Card title</h5>
        <h6 class="card-subtitle mb-2 text-muted">Card subtitle</h6>
    <p class="card-text">Some quick example text to build on the card title and make up the bulk of the card's content.</p>
       <a href="#" class="btn mr-2"><i class="fas fa-link"></i> Visit Site</a>
    <a href="#" class="btn "><i class="fab fa-github"></i> Github</a>
  </div>
  </div>
    </div> 
 -->